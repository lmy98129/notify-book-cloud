<!--pages/profile/profile.wxml-->
<view class="root {{introStatus}}">
  <view class="container {{fixVeryTop ? 'fixed':''}}">
    <top-widget avatarUrl="{{avatarUrl}}" nickname="{{nickname}}" fixTop="{{fixTop}}" class="top-widget-wrapper" isBack="{{true}}" mode="center">
      <nav-btn slot="edit" btnType="edit" iconType="icon-bianji" bind:tapBtn="editProfile"/>
    </top-widget>

      <block wx:if="{{profileStatus === 1}}">
        <view class="main" id="global">
          <view class="tabbar">
            <view class="tabbar-item {{tabIndex === 0 ? 'selected':''}}" bindtap="tabHandler" data-index="0">基本资料</view>
            <view class="tabbar-item {{tabIndex === 1 ? 'selected':''}}" bindtap="tabHandler" data-index="1">自我介绍</view>
          </view>
          <swiper current="{{tabIndex}}" bindchange="bindSwiper" duration="{{500}}" style="height: {{swiperHeight}}px">
            <swiper-item class="swipere-item">
              <view class="main">
                <block wx:for="{{userInfo}}" wx:key="{{index}}">
                  <profile-item title="{{item.title}}" content="{{item.content}}" class="profile-item-wrapper"></profile-item>
                </block>
          
                <view class="item-wrapper">
                  <view class="item-title">联系方式</view>
                  <block wx:for="{{contactArray}}" wx:key="{{index}}">
                    <profile-item title="{{item.contactType.content}}" content="{{item.content.content}}" class="profile-item-wrapper"></profile-item>
                  </block>
                </view>
            
                <block wx:for="{{jobArray}}" wx:key="{{index}}">
                  <view class="item-wrapper">
                    <view class="item-title">工作职务 {{index + 1}}</view>
                    <profile-item title="{{item.institution.title}}" content="{{item.institution.content}}" class="profile-item-wrapper"></profile-item>
                    <profile-item title="{{item.job.title}}" content="{{item.job.content}}" class="profile-item-wrapper"></profile-item>
                    <profile-item title="{{item.jobStartTime.title}}" content="{{item.jobStartTime.content}}" class="profile-item-wrapper"></profile-item>
                    <profile-item title="{{item.jobEndTime.title}}" content="{{item.jobEndTime.content}}" class="profile-item-wrapper"></profile-item>
                  </view>
                </block>        
              </view>
            </swiper-item>
            <swiper-item>
              <view class="intro-wrapper" id="intro">
                <block wx:if="{{(intro === undefined || intro === '') && introStatus === 'default'}}">
                  <view class="add-hint"><text>介绍自己\n让校友们更好地认识您</text></view>
                  <button class="add-btn" type="default" bindtap="addIntro">
                    添加自我介绍
                  </button>
                </block>
                <block wx:else>
                  <view class="intro">{{intro}}</view>
                  <button class="edit-btn" type="default" bindtap="addIntro">
                    修改自我介绍
                  </button>
                </block>
              </view>
            </swiper-item>
          </swiper>
        </view> 
      </block>

      <block wx:if="{{profileStatus === -1}}">
        <view class="hint-wrapper">
            <view class="upper">
              <image src="/images/contact-hl.png"></image>
            </view>
            <view class="hint">
              <text>资料暂时为空\n请点击右上角编辑按钮填写\n首次填写需要认证审核</text>
            </view>
        </view>
      </block>

      <block wx:if="{{introStatus === 'editing'}}">
        <view class="float-wrap">
          <textarea placeholder="请输入自我介绍" maxlength="-1" fixed="{{true}}" class="intro-input" bindinput="introInput" auto-focus="{{true}}" value="{{tmpIntro}}" focus="{{true}}"></textarea>
          <view class="btn-wrap">
            <button class="cancel-btn" type="default" bindtap="cancelIntro">
              取消
            </button>
            <button class="submit-btn" type="default" bindtap="submitIntro">
              提交
            </button>
          </view>
        </view>
      </block>

      
  </view>
  
</view>
